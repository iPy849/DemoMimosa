---
import PageLayout from '../../layouts/PageLayout.astro';
import Icon from '../../components/icons/Icon.astro';
import { t } from '../../i18n/utils';
import { getCollection } from 'astro:content';

const allPosts = await getCollection('blog', ({ data }) => data.lang === 'es');
const posts = allPosts.sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime());
---

<PageLayout
  title="Blog & Estilo de Vida | MIMOSA Real Estate"
  description="Articulos sobre tendencias de diseno, oportunidades de inversion y estilo de vida en el Caribe Mexicano."
  keywords="blog, estilo de vida, tendencias, diseno, inversion, caribe mexicano, bienes raices lujo"
>
  <section class="pt-32 pb-24 px-6">
    <div class="max-w-7xl mx-auto">
      <div class="text-center mb-16 reveal" data-reveal="fade">
        <p class="text-primary text-sm tracking-[0.3em] uppercase mb-2 font-body" data-t="blog.subtitle">{t("blog.subtitle")}</p>
        <h1 class="text-4xl md:text-5xl font-headline font-bold text-foreground" data-t="blog.title">{t("blog.title")}</h1>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-5xl mx-auto reveal-stagger">
        {posts.map((post) => (
          <a href={`/blog/${post.data.slug}`} class="group block reveal">
            <article class="bg-card rounded-lg overflow-hidden border border-border hover:shadow-lg transition-all duration-300 group-hover:-translate-y-1">
              <div class="relative aspect-[16/10] overflow-hidden">
                <img src={post.data.image} alt={post.data.title} class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105" loading="lazy" />
              </div>
              <div class="p-6">
                <div class="flex items-center gap-4 text-sm text-muted-foreground mb-3 font-body">
                  <span class="flex items-center gap-1">
                    <Icon name="calendar" class="w-4 h-4" />
                    {post.data.date}
                  </span>
                  <span class="flex items-center gap-1">
                    <Icon name="user" class="w-4 h-4" />
                    {post.data.author}
                  </span>
                </div>
                <h2 class="text-xl font-headline font-semibold mb-2 text-foreground group-hover:text-primary transition-colors">{post.data.title}</h2>
                <p class="text-muted-foreground font-body text-sm leading-relaxed mb-4">{post.data.excerpt}</p>
                <span class="text-primary text-sm font-bold tracking-wider uppercase font-body inline-flex items-center gap-2 group-hover:gap-3 transition-all" data-t="blog.read_more">
                  {t("blog.read_more")}
                  <Icon name="arrow-right" class="w-4 h-4" />
                </span>
              </div>
            </article>
          </a>
        ))}
      </div>
    </div>
  </section>
</PageLayout>
